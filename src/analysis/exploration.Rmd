---
title: "R Notebook: initial exploration for Gas Cost Estimator"
output: html_notebook
---

```{r fig.width=20}
library(sqldf)
```

Read in the `programs.csv` as generated by `src/program_generator.py` with `--fullCSV` flag on
```{r fig.width=20}
setwd("~/sources/imapp/gas-cost-estimator/src")
programs = read.csv("../../programs.csv")
head(programs)
```

Read in the `result.csv` as generated by `src/measurements.py`

```{r fig.width=20}
setwd("~/sources/imapp/gas-cost-estimator/src")
results = read.csv("../../result.csv")
head(results)
```

Combine the two tables to see only times of the measured opcodes.

```{r fig.width=20}
measurements = sqldf("SELECT opcode_measured, sample_id, run_id, measure_all_time_ns
                     FROM results
                     INNER JOIN programs ON(results.program_id = programs.program_id)
                     WHERE results.instruction_id = programs.measured_op_position")

head(measurements)
                     
```

Quick overview of times everything:

```{r fig.width=20}
summary(measurements$measure_all_time_ns)
```

Quick overview of measurements per opcode:
```{r fig.width=20}
tapply(measurements$measure_all_time_ns, measurements$opcode_measured, summary)
```

```{r fig.width=20}
boxplot(measure_all_time_ns ~ opcode_measured, data=measurements, las=2)
```

Quick check that `sample_id` shouldn't impact measurements:

```{r fig.width=20}
boxplot(measure_all_time_ns ~ sample_id, data=measurements, las=2)
```

But `run_id` does impact measurements: first several runs have a decreasing trend. **TODO** needs investigation how/if to alleviate:

```{r fig.width=20}
boxplot(measure_all_time_ns ~ run_id, data=measurements, las=2)
```